<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <script src="./script/app.js" defer></script>
    <link rel="icon" href="./images/favicon.ico">
    <title>Calculator</title>
</head>
<body>
    <div class="main">
        <div class="calculator">
            <div class="screen">
                <div id="last-operation"></div>
                <div id="current-operation"></div>
            </div>
            <div class="buttons-area top">
                <button id="clear" value="clear">Clear</button>
                <button id="delete" value="delete">Delete</button>
            </div>
            <div class="buttons-area" id="working-area">
                <button class="num" value="7">7</button>
                <button class="num" value="8">8</button>
                <button class="num" value="9">9</button>
                <button class="operator" value="/">&#247;</button>
                <button class="num" value="4">4</button>
                <button class="num" value="5">5</button>
                <button class="num" value="6">6</button>
                <button class="operator" value="*">&#0215;</button>
                <button class="num" value="1">1</button>
                <button class="num" value="2">2</button>
                <button class="num" value="3">3</button>
                <button class="operator" value="-">-</button>
                <button class="num" value=".">.</button>
                <button class="num" value="0">0</button>
                <button class="equality" value="=">=</button>
                <button class="operator" value="+">+</button>
            </div>
        </div>
    </div>
</body>

<script>
//initiateCalculator ();

 //   function initiateCalculator () {
        const clear = document.querySelector ('#clear')
        const deletion = document.querySelector ('#delete')
        const numbers = document.querySelectorAll ('.num');
        const operators = document.querySelectorAll ('.operator');
        //const point = document.querySelector ('.point');
        const equality = document.querySelector ('.equality');
        let mainDisplay = document.querySelector("#current-operation");
        let topDisplay = document.querySelector("#last-operation");

        let firstNumber = '';
        let secondNumber = '';
        let operator = '';
        let result = 0;
        let temp = 0;
        mainDisplay.innerText = 0;

        clear.addEventListener ('click', clearAll)
        numbers.forEach(number => number.addEventListener('click', setNumbers));
        operators.forEach(operator => operator.addEventListener('click', selectOperator));
        equality.addEventListener('click', operate)
        deletion.addEventListener ('click', deleteNumber)

        function deleteNumber () {
            mainDisplay.innerText.length == 1 ? mainDisplay.innerText = 0 
            : mainDisplay.innerText = mainDisplay.innerText.slice(0,-1);
            updateOnDeletion ();
        }

        function updateOnDeletion () {
            if (topDisplay.innerText.includes(`${operator}`)) {
                secondNumber.length <= 1 ? secondNumber = '' : secondNumber = secondNumber.slice(0,-1)
            }
        }

        function clearAll () {
            firstNumber = '';
            secondNumber = '';
            operator = '';
            result = 0;
            topDisplay.innerText = '';
            mainDisplay.innerText = 0;
        }

        function setNumbers (e) {
            !firstNumber ? setFirstNumber(e) : setSecondNumber(e);
        }
        function setFirstNumber(e) {
            mainDisplay.innerText == 0 ? mainDisplay.innerText = e.target.value : mainDisplay.innerText += e.target.value;
        }

        function selectOperator (e) {
            if (topDisplay.innerText.includes("=")) {
                resetSecondNumber();
            }
            firstNumber = mainDisplay.innerText;
            operator = e.target.value;
            topDisplay.innerText = mainDisplay.innerText + e.target.value;
        }

        function setSecondNumber(e) {
            !secondNumber ? secondNumber = e.target.value : secondNumber += e.target.value;
            mainDisplay.innerText = secondNumber;
        }
        function operate() {
            if (secondNumber != "") {
                switch (operator) {
                     case "+":
                         result = parseFloat (firstNumber) + parseFloat(secondNumber);
                         break;
                     case "-":
                         result = firstNumber - secondNumber;
                         break
                     case "*":
                         result =  firstNumber * secondNumber;
                         break;
                     case "/":
                         result =  firstNumber / secondNumber;
                         break;
                }
            equalDisplay();
            }
        }

        function operateOnSecondEquality() {
            if (secondNumber != "") {
                switch (operator) {
                     case "+":
                         result = parseFloat (firstNumber) + parseFloat(secondNumber);
                         break;
                     case "-":
                         result = firstNumber - secondNumber;
                         break
                     case "*":
                         result =  firstNumber * secondNumber;
                         break;
                     case "/":
                         result =  firstNumber / secondNumber;
                         break;
                }
            }
        }

        function equalDisplay() {
            if (!topDisplay.innerText.includes("=")) {
                topDisplay.innerText += `${secondNumber}=`;
                mainDisplay.innerText = result;    
            }
            else {
                temp = result;
                firstNumber = temp;
                topDisplay.innerText = `${firstNumber}${operator}${secondNumber}=`;
                operateOnSecondEquality();
                mainDisplay.innerText = result; 
            }
        }

        function resetSecondNumber() {
            secondNumber = '';
        }
    

/*
        let obj = {
            firstValue: 0,
            secondValue: null,
            operator: '',
            result: null,
            switchNumberFlag: false,
            equalityFlag: false,
        };

        function setNumbers(e) {
        // switch functions to set First, then second number.
            obj.switchNumberFlag === false ? setFirstNumber (e) : setSecondNumber (e);
        }
        function setFirstNumber (e) {
            obj.firstValue === 0 ? obj.firstValue = e.target.value : obj.firstValue += e.target.value;
            obj.firstValue[0] == 0 && obj.firstValue.length > 1 ? obj.firstValue = obj.firstValue.slice(1) : obj.firstValue = obj.firstValue; // if 0 is selected first
            currentOperation.textContent = obj.firstValue;
        }

        function setSecondNumber (e) {
            obj.secondValue === null ? obj.secondValue = e.target.value : obj.secondValue += e.target.value;
            obj.secondValue[0] == 0 && obj.secondValue.length > 1 ? obj.secondValue = obj.secondValue.slice(1) : obj.secondValue = obj.secondValue; // if 0 is selected first
            currentOperation.textContent = obj.secondValue;
        }

        function selectOperator(e) {
            obj.operator = e.target.value; //select operator
            changeSecondNumFlag(); // set to true to avoid displaying extra number and extra operator when hitting operator 2nd time
            if (obj.switchNumberFlag === true) {
                previousOperation.textContent += obj.firstValue;
                previousOperation.textContent += obj.operator;
            }
            // allow changing the operator 
            //previousOperation.textContent = currentOperation.textContent + obj.operator; 

        }
//            if (obj.operatorCounter > 1){
//               operate (); // invoke function if two values are entered and another operation is requested skipping equality.
//                obj.operatorCounter--;
//            };

        function changeSecondNumFlag() {
            obj.switchNumberFlag === false ? obj.switchNumberFlag = true : obj.switchNumberFlag = false;
        }
    
        function changeEqualityFlag() {
            obj.equalityFlag === false ? obj.equalityFlag = true : obj.equalityFlag = false;
        }
        function operate() {
            switch (obj.operator) {
                case "+":
                    add();
                    break;
                case "-":
                    subtract();
                    break
                case "*":
                    multiply();
                    break;
                case "/":
                    divide();
                    break;
            }
            equal();
        }
    
        function add() {
            obj.result = parseInt (obj.firstValue) + parseInt(obj.secondValue);
        }

        function subtract() {
            obj.result = obj.firstValue - obj.secondValue;
        }

        function multiply() {
            obj.result =  obj.firstValue * obj.secondValue;
        }

        function divide() {
            obj.result =  obj.firstValue / obj.secondValue;
        }

        function equal () {
            previousOperation.textContent += `${obj.secondValue}`;
            previousOperation.textContent += `=`;
            currentOperation.textContent = obj['result'];
            changeValues ();   
            changeEqualityFlag ();         
        }


        function changeValues () {
            obj ['firstValue'] = obj['result']; 

            /*
            previousOperation.textContent = obj ['firstValue'];
            previousOperation.textContent += obj ['operator'];
            previousOperation.textContent += obj ['secondValue'];
            obj.equalityCounter = 1;
            */

        



</script>
</html>
