<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <script src="./script/app.js" defer></script>
    <link rel="icon" href="./images/favicon.ico">
    <title>Calculator</title>
</head>
<body>
    <div class="main">
        <div class="calculator">
            <div class="screen">
                <div id="last-operation"></div>
                <div id="current-operation"></div>
            </div>
            <div class="buttons-area top">
                <button id="clear" value="clear">Clear</button>
                <button id="delete" value="delete">Delete</button>
            </div>
            <div class="buttons-area" id="working-area">
                <button class="num" value="7">7</button>
                <button class="num" value="8">8</button>
                <button class="num" value="9">9</button>
                <button class="operator" value="/">&#247;</button>
                <button class="num" value="4">4</button>
                <button class="num" value="5">5</button>
                <button class="num" value="6">6</button>
                <button class="operator" value="*">&#0215;</button>
                <button class="num" value="1">1</button>
                <button class="num" value="2">2</button>
                <button class="num" value="3">3</button>
                <button class="operator" value="-">-</button>
                <button class="point" value=".">.</button>
                <button class="num" value="0">0</button>
                <button class="equality" value="=">=</button>
                <button class="operator" value="+">+</button>
            </div>
        </div>
    </div>
</body>

<script>
//initiateCalculator ();

 //   function initiateCalculator () {
        const numbers = document.querySelectorAll ('.num');
        const operators = document.querySelectorAll ('.operator');
        const point = document.querySelector ('.point');
        const equality = document.querySelector ('.equality');
        let currentOperation = document.querySelector("#current-operation");
        let previousOperation = document.querySelector("#last-operation");

        //let flag = false;

        currentOperation.textContent = 0;
        numbers.forEach(number => number.addEventListener('click', setNumbers));
        operators.forEach(operator => operator.addEventListener('click', selectOperator));
        equality.addEventListener('click', operate)

        let obj = {
            firstValue: 0,
            secondValue: 0,
            operator: '',
            result: 0,
            switchNumberFlag: false,
            secondValueCounter: 0,
            equalityCounter: 0,
            operatorCounter: 0,
        };

        function setNumbers(e) {
        // switch functions to set First, then second number.
            obj.switchNumberFlag === false ? setFirstNumber (e) : setSecondNumber (e);
        }
        function setFirstNumber (e) {
            obj.firstValue === 0 ? obj.firstValue = e.target.value : obj.firstValue += e.target.value;
            obj.firstValue[0] == 0 && obj.firstValue.length > 1 ? obj.firstValue = obj.firstValue.slice(1) : obj.firstValue = obj.firstValue; // if 0 is selected first
            currentOperation.textContent = obj.firstValue;
        }

        function setSecondNumber (e) {
            obj.secondValue === 0 ? obj.secondValue = e.target.value : obj.secondValue += e.target.value;
            obj.secondValue[0] == 0 && obj.secondValue.length > 1 ? obj.secondValue = obj.secondValue.slice(1) : obj.secondValue = obj.secondValue; // if 0 is selected first
            currentOperation.textContent = obj.secondValue;
        }

        function selectOperator(e) {
            obj.operator = e.target.value; //select operator
            obj.switchNumberFlag = true; // start setting second number 
            if (obj.operatorCounter < 1) {
                previousOperation.textContent += obj.firstValue;
                previousOperation.textContent += obj.operator;
            }
  
            ++obj.operatorCounter;
            if (obj.operatorCounter > 1){
                operate (); // invoke function if two values are entered and another operation is requested skipping equality.
                obj.operatorCounter--;
            };


/*            if (previousOperation.textContent.includes('=')) {
                previousOperation.textContent = obj.firstValue;
                previousOperation.textContent += obj.operator;
            }
            */
        }
    
        function operate() {
            switch (obj.operator) {
                case "+":
                    add();
                    break;
                case "-":
                    subtract();
                    break
                case "*":
                    multiply();
                    break;
                case "/":
                    divide();
                    break;
            }
            displayResult();
        }
    
        function add() {
            obj.result = parseInt (obj.firstValue) + parseInt(obj.secondValue);
        }

        function subtract() {
            obj.result = obj.firstValue - obj.secondValue;
        }

        function multiply() {
            obj.result =  obj.firstValue * obj.secondValue;
        }

        function divide() {
            obj.result =  obj.firstValue / obj.secondValue;
        }

        function displayResult () {
            previousOperation.textContent += `${obj.secondValue}`;
            previousOperation.textContent += `=`;
            currentOperation.textContent = obj['result'];
            //obj.equalityCounter++;
            if (obj.equalityCounter>1) {
                keepCalculating ();
            }
            
        }


        function keepCalculating () {
            obj ['firstValue'] = obj['result']; 

            /*
            previousOperation.textContent = obj ['firstValue'];
            previousOperation.textContent += obj ['operator'];
            previousOperation.textContent += obj ['secondValue'];
            obj.equalityCounter = 1;
            */

        }
//}
</script>
</html>
// 1. assign firstValue 
// 2. assign operator
// 3. assign secondValue
// 4. on equality or second perform operation;
// 1. show result. 
// 2. if equality is pressed again, then assign result to firstValue
// 3. repeat calculation 